doctype html
html

	head
		block title

		meta(name='viewport', content='width=device-width, initial-scale=1, maximum-scale=1')
		meta(name='robots', content='INDEX, FOLLOW')
		
		link(rel='icon', type='image/png', href='/static/img/pentacle-simple.png')
		link(rel='stylesheet', type='text/css', href='//fonts.googleapis.com/css?family=Pathway+Gothic+One')
		link(rel='stylesheet', type='text/css', href='//fonts.googleapis.com/css?family=Denk+One&subset=latin,latin-ext')
		link(rel='stylesheet', type='text/css', href='//fonts.googleapis.com/css?family=Armata&subset=latin,latin-ext')
		link(rel='stylesheet', type='text/css', href='/static/scss/theme.css')
		block css
			link(rel='stylesheet', type='text/css', href='/static/scss/dialog.css')

		script(src='https://login.persona.org/include.js')
		script(src='/static/js/modernizr.custom.07098.js')
		script(src='/static/js/jquery-1.10.1.js')
		script(src='/static/js/ie-fail.js')
		script(src='/static/js/login.js')
		script(src='/static/js/langselect.js')
		block js

		script!= 'var userInfo = ' + JSON.stringify({username: logged_user, email: logged_user_email, persona_user: persona_user}) + ';'
		script!= 'var localeInfo = ' + JSON.stringify({pathLocale: i18n.pathLocale}) + ';'
		script.
			function setLangCookie(native){
				if(native){
					document.cookie = '#{i18n.config.cookie}=#{i18n.nativeLocale}; max-age=31536e3; path=/';
					return true;
				}
				else {
					document.cookie = '#{i18n.config.cookie}=#{i18n.selectedLocale}; max-age=31536e3; path=/';
					window.location.reload(true);
					return false;
				}
			}



	body
		.wrapper
			header
				nav
					ul
						li: a(href=url('/')) ToonStore
						li: a(href=url('/site/about'))= __('nav.about')
						li: a(href=url('/site/contact'))= __('nav.contact')
					ul
						if logged_user_email
							li: a(href=url('/'+logged_user))= logged_user
							li: input.fakelink(type='button', onclick='logout()', value=__('nav.logout'))
						else
							li: a(href=url('/register'))= __('nav.register')
							if template == 'charsheet/base' || template == 'userpage'
								li: a(href=url('/login?redirect=#{page}'))= __('nav.login')
							else
								li: a(href=url('/login'))= __('nav.login')

				block navigation

			.content
				if i18n.nativeLocale && i18n.nativeLocale !== i18n.selectedLocale
					aside#lang-message.content-block.info= n__('nav.lang_dialog.prompt', i18n.nativeLocale)
						br
						a(href=getNativeURL(), hreflang=i18n.nativeLocale, onclick='return setLangCookie(true);')= n__('nav.lang_dialog.accept')
						|  <> 
						input.fakelink(type='button', onclick='return setLangCookie(false);', value=n__('nav.lang_dialog.reject'))

				if message
					aside#page-message.content-block(class=message.type)= message.content

				block content

					article

						header.content-block
							block article_header

						section.content-block.normalbox
							block article_body


			footer: nav
				ul
					li: a(href=url('/site/terms'))= __('nav.terms')
					li: a(href=url('/site/privacy'))= __('nav.privacy')
					li: a(href=url('/site/donate'))= __('nav.donate')
					li.langselectmenu
						= __('nav.language')
						img.langselecticon(src='/static/img/flags/#{i18n.selectedLocale}.png', alt=__('language'), title=__('language'))

						ul.langselect
							- for( var i=0; i<i18n.config.locales.length; i++ )
								unless i18n.config.locales[i] === i18n.selectedLocale
									li: a(href=getNativeURL(i18n.config.locales[i]), hreflang=i18n.config.locales[i])
										- var descriptor = a__({locale:i18n.config.locales[i], phrase:"language"});
										img.icon(src='/static/img/flags/#{i18n.config.locales[i]}.png', alt=descriptor, title=descriptor)
							li.active
								img.icon(src='/static/img/flags/#{i18n.selectedLocale}.png', alt=__('language'), title=__('language'))

		block github
